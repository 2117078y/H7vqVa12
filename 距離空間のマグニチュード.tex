\documentclass[10pt, fleqn, label-section=none]{bxjsarticle}

%\usepackage[driver=dvipdfm,hmargin=25truemm,vmargin=25truemm]{geometry}

\setpagelayout{driver=dvipdfm,hmargin=25truemm,vmargin=20truemm}


\usepackage{amsmath}
\usepackage{amssymb}
\usepackage{amsfonts}
\usepackage{amsthm}
\usepackage{mathtools}
\usepackage{mleftright}

\usepackage{ascmac}




\usepackage{otf}

\theoremstyle{definition}
\newtheorem{dfn}{定義}[section]
\newtheorem{ex}[dfn]{例}
\newtheorem{lem}[dfn]{補題}
\newtheorem{prop}[dfn]{命題}
\newtheorem{thm}[dfn]{定理}
\newtheorem{setting}[dfn]{設定}
\newtheorem{notation}[dfn]{記号}
\newtheorem{cor}[dfn]{系}
\newtheorem*{pf*}{証明}
\newtheorem{problem}[dfn]{問題}
\newtheorem*{problem*}{問題}
\newtheorem{remark}[dfn]{注意}
\newtheorem*{claim*}{\underline{claim}}



\newtheorem*{solution*}{解答}

%箇条書きの様式
\renewcommand{\labelenumi}{(\arabic{enumi})}


%

\newcommand{\forany}{\rm{for} \ {}^{\forall}}
\newcommand{\foranyeps}{
\rm{for} \ {}^{\forall}\varepsilon >0}
\newcommand{\foranyk}{
\rm{for} \ {}^{\forall}k}


\newcommand{\any}{{}^{\forall}}
\newcommand{\suchthat}{\, \rm{s.t.} \, \it{}}




\newcommand{\veps}{\varepsilon}
\newcommand{\paren}[1]{\mleft( #1\mright )}
\newcommand{\cbra}[1]{\mleft\{#1\mright\}}
\newcommand{\sbra}[1]{\mleft\lbrack#1\mright\rbrack}
\newcommand{\tbra}[1]{\mleft\langle#1\mright\rangle}
\newcommand{\abs}[1]{\left|#1\right|}
\newcommand{\norm}[1]{\left\|#1\right\|}
\newcommand{\lopen}[1]{\mleft(#1\mright\rbrack}
\newcommand{\ropen}[1]{\mleft\lbrack #1 \mright)}



%
\newcommand{\Rn}{\mathbb{R}^n}
\newcommand{\Cn}{\mathbb{C}^n}

\newcommand{\Rm}{\mathbb{R}^m}
\newcommand{\Cm}{\mathbb{C}^m}


\newcommand{\projs}[2]{\it{p}_{#1,\ldots,#2}}
\newcommand{\projproj}[2]{\it{p}_{#1,#2}}

\newcommand{\proj}[1]{p_{#1}}

%可測空間
\newcommand{\stdProbSp}{\paren{\Omega, \mathcal{F}, P}}

%微分作用素
\newcommand{\ddt}{\frac{d}{dt}}
\newcommand{\ddx}{\frac{d}{dx}}
\newcommand{\ddy}{\frac{d}{dy}}

\newcommand{\delt}{\frac{\partial}{\partial t}}
\newcommand{\delx}{\frac{\partial}{\partial x}}

%ハイフン
\newcommand{\hyphen}{\text{-}}

%displaystyle
\newcommand{\dstyle}{\displaystyle}

%⇔, ⇒, \UTF{21D0}%
\newcommand{\LR}{\Leftrightarrow}
\newcommand{\naraba}{\Rightarrow}
\newcommand{\gyaku}{\Leftarrow}

%理由
\newcommand{\naze}[1]{\paren{\because {\mathop{ #1 }}}}

%
\newcommand{\sankaku}{\hfill $\triangle$}

%
\newcommand{\push}{_{\#}}

%手抜き
\newcommand{\textif}{\textrm{if}\,\,\,}
\newcommand{\Ric}{\textrm{Ric}}
\newcommand{\tr}{\textrm{tr}}
\newcommand{\vol}{\textrm{vol}}
\newcommand{\diam}{\textrm{diam}}
\newcommand{\supp}{\textrm{supp}}
\newcommand{\Med}{\textrm{Med}}
\newcommand{\Leb}{\textrm{Leb}}
\newcommand{\Const}{\textrm{Const}}
\newcommand{\Avg}{\textrm{Avg}}
\newcommand{\id}{\textrm{id}}
\newcommand{\Ker}{\textrm{Ker}}
\newcommand{\im}{\textrm{Im}}
\newcommand{\dil}{\textrm{dil}}
\newcommand{\Ch}{\textrm{Ch}}
\newcommand{\Lip}{\textrm{Lip}}
\newcommand{\Ent}{\textrm{Ent}}
\newcommand{\grad}{\textrm{grad}}
\newcommand{\dom}{\textrm{dom}}
\newcommand{\diag}{\textrm{diag}}

\renewcommand{\;}{\, ; \,}
\renewcommand{\d}{\, {d}}

\newcommand{\gyouretsu}[1]{\begin{pmatrix} #1 \end{pmatrix} }


%%図式

\usepackage[dvipdfm,all]{xy}


\newenvironment{claim}[1]{\par\noindent\underline{step:}\space#1}{}
\newenvironment{claimproof}[1]{\par\noindent{($\because$)}\space#1}{\hfill $\blacktriangle $}


\newcommand{\pprime}{{\prime \prime}}

%%マグニチュード


\newcommand{\Mag}{\textrm{Mag}}

\usepackage{mathrsfs}


\title{距離空間のマグニチュード}
\date{}


\author{}


\begin{document}


\maketitle

\section{マグニチュード}

\subsection{有限距離空間のマグニチュード}

\begin{dfn}(類似度行列). $(X, d)$ を有限距離空間とする.
\begin{align*} Z: X \times X \rightarrow \mathbb R; (x, y) \mapsto e^{-d(x,y)}\end{align*}
を$(X, d)$ の類似度行列という. 
\end{dfn}


\begin{dfn}(ウェイト, コウェイト). $(X, d)$ を有限距離空間, $Z$ を$X$ の類似度行列とする. $w: X \rightarrow \mathbb R$ で, 任意の$p \in X$ に対して
\begin{align*} \sum_{x \in X }Z(p, x) w(x) = 1 \end{align*}
を満たすものを, $X$ のウェイトという. また, 任意の$p \in X$ に対して
\begin{align*} \sum_{x \in X}w(x) Z(x, p) = 1 \end{align*}
を満たすものを, $X$ のコウェイトという. 
\end{dfn}

\begin{prop}$(X, d)$ を有限距離空間, $w, v$ を$X$ のウェイトとする. このとき, 
\begin{align*} \sum_{x \in X} w(x) = \sum_{x \in X} v(x)\end{align*}
が成り立つ. 
\end{prop}
\begin{pf*}
\begin{align*} \sum_{x \in X} w(x) = \sum_{x \in X}(\sum_{y \in X}v(y)Z(y, x)) w(x) = \sum_{y \in X} v(y) \end{align*}
\qed
\end{pf*}


\begin{dfn}(有限距離空間のマグニチュード). $(X, d)$ を有限距離空間とする. $X$ のウェイト$w$ が存在する時, $X$ はマグニチュードをもつといい, 
\begin{align*} \Mag(X) \coloneqq \sum_{x \in X } w(x)   \end{align*}
と定め, この値を$X$ のマグニチュードという. 
\end{dfn}

\begin{remark}$X$ のマグニチュードはウェイトのとりかたに依らない. 

\end{remark}



\begin{dfn}(メビウス行列). $(X, d)$ を有限距離空間, $Z$ を$X$ の類似度行列とする. 
\begin{align*} M: X \times X \rightarrow \mathbb R\end{align*} 
で, 任意の$x,y \in X$ に対して
\begin{align*} \sum_{z \in X} Z(x, z) M(z, y) = \delta (x,y) \end{align*}
を満たす写像を$X$ のメビウス行列という. 
\end{dfn}

\begin{prop}\label{1703}$(X, d)$ を有限距離空間とする. $X$ のメビウス行列$M$が存在するならば, $X$ のウェイト$w$は存在し, 
\begin{align*} w(x) = \sum_{y \in X} M(x, y) \quad (\any x \in X)\end{align*}
が成り立つ. 
\end{prop}
\begin{pf*}
実際, 
\begin{align*} \sum_{y \in X} (Z(x,y) \sum_{z \in X} M(y, z) )= \sum_{z \in X} \sum_{y \in X} Z(x, y)M(y, z) = \sum_{z \in X} \delta(x, z) = 1   \end{align*}
が成り立つ. 
\qed
\end{pf*}

\begin{remark}メビウス行列が存在するならウェイトは存在するが, ウェイトが存在したからといってメビウス行列が存在するとは限らない. 

\end{remark}




\begin{prop}$(X, d)$ を有限距離空間とする. $X$ のメビウス行列が存在するならば, 
\begin{align*} \Mag(X) = \sum_{(x, y) \in X \times X} M(x,y) \end{align*}
が成り立つ.
\end{prop}
\begin{pf*}
\begin{align*} \sum_{(x, y) \in X \times X} M(x,y) &= \sum_{x \in X} \sum_{y \in X} M(x,y) = \sum_{x \in X} \sum_{y \in X} (M(x,y) \sum_{z \in X} Z(y, z) )w(z) \\ &= \sum_{x\in X} \sum_{y\in X}  \sum_{z\in X} M(x, y)Z(y, z) w(z) =  \sum_{z \in X} w(z)   \end{align*}
\qed
\end{pf*}



\begin{prop}$(X, d)$ を有限距離空間とする. 
\begin{align*} \# \cbra{t  \in (0, \infty) \mid tX \textrm{はマグニチュードを持たない}  } < \infty \end{align*}
が成り立つ. 
\end{prop}
\begin{pf*}$N \coloneqq \#X$ とし, 距離空間$tX = (X, td)$ の類似度行列を$Z^{tX}$ で表すことにする. 
$M_N(\mathbb R)$において, 正則行列全体$GL_N (\mathbb R)$は開集合であるので, 単位行列$I$ の開近傍$U_I$ で$U_I \subset GL_N( \mathbb R)$ を満たすものがとれる. $\lim_{t \rightarrow \infty } Z^{tX} = I$ であるので, 
十分大きな$T$ をとると, $t \in (0, T) \naraba \det Z^{tX} = 0$ が成り立つようにできる. 
\begin{align*} f: \mathbb C \rightarrow \mathbb C; t \mapsto Z^{tX}\end{align*}
により正則関数を定める. $f$ が$(0, T)$ に無限個のゼロ点を持つとすると, 相対点列コンパクトであることから, $\mathbb C$ における収束部分列をもつ. 従って, $f$ が正則関数であることから, 一致の定理より$f$ は$\mathbb C$ 全体で$0$ となるが, これは矛盾である. 故に, ゼロ点は$(0, T)$ に高々有限個しか存在しない. 
\qed
\end{pf*}



\subsection{様々な空間のマグニチュード}



\begin{prop}($2$点空間のマグニチュード). 距離空間$X = (\cbra{p,q}, d)$ のマグニチュードは, 
\begin{align*} \Mag(X) =  1 + \tanh \frac{e^{d(p,q)  } }{2}  \end{align*}
\end{prop}
\begin{pf*}
\begin{align*}  \gyouretsu{1 & e^{-d(p,q)} \\ e^{-d(p,q)}  & 1  } \gyouretsu{\frac{1}{1 + e^{-d(p,q)} } \\ \frac{1}{1 + e^{-d(p,q)} } } = \gyouretsu{1 \\ 1}. \\ 
\frac{2}{1 + e^{-d(p,q)} }  =   \frac{2 e^{d(p,q)}}{   e^{d(p,q)   } + 1} = \frac{ e^{d(p,q)}  + 1 +  e^{d(p,q)}   -1}{ e^{d(p,q)  } + 1} = 1 + \frac{e^{d(p,q)  } - 1}{e^{d(p,q)  } + 1 } 
\end{align*}

\qed
\end{pf*}



\begin{prop}($l_1$直積距離空間のマグニチュード). $(X, d_X), (Y, d_Y)$ を有限距離空間とする. 
\begin{align*} d_{X\times Y}^{l_1} ((x_0, y_0), (x_1, y_1)) \coloneqq d_X (x_0, x_1) + d_Y (y_0, y_1)\end{align*}
とする. 距離空間$X \times_1 Y = (X \times Y, d_{X\times Y}^{l_1} ) $ のマグニチュードは
\begin{align*} \Mag(X \times _1 Y ) = \Mag(X) \Mag(Y) \end{align*}
で与えられる.
\end{prop}
\begin{pf*}$X = \cbra{x_1, \ldots, x_N}, Y = \cbra{y_1, \ldots , Y_M}$ とする. 
$d((x_i, y_k), (x_j, y_l)) = d(x_i, x_j) + d(y_k, y_l ) $ より, 
\begin{align*} e^{- d((x_i, y_k), (x_j, y_l)) } = e^{-d(x_i, x_j) } e^{-d(y_k, y_l ) }\end{align*}
であるので, $w^{X\times Y}_{ik} = w^X_i w^Y_k$ と定めるとこれはウェイトになることが簡単な計算でわかる. 
\qed
\end{pf*}




\begin{dfn}(斉次距離空間). 
$(X, d)$ を距離空間とする. 群$G$で$X$に等長かつ推移的に作用するものが存在するとき, $(X, d)$ を斉次距離空間という. 

\end{dfn}




\begin{notation}$(X, d)$ を距離空間, $G$ を$X$ に作用する推移的な群とする. $x, y \in X$ に対して 
\begin{align*} g x = y \end{align*}
を満たす$g$ を$g^{x}_y$ で表すことにする.
\end{notation}




\begin{prop}$G$ を$(X, d)$ に推移的かつ等長な作用をする群とする. 任意の$g \in G$ について
\begin{align*} g: X \rightarrow X\end{align*}
は全単射等長写像である.
\end{prop}
\begin{pf*}任意の$x \in X$ に対して
\begin{align*} g g^{-1}x = x\end{align*}
なので$g$ は全射である. 等長的であるので, 単射である. 故に主張が従う.
\qed
\end{pf*}




\begin{prop}$(X, d)$ を有限な斉次距離空間とする. 任意の$g \in G$ と, 任意の$p, q \in X$ に対して 
\begin{align*}  \sum_{p \in X} d(x, p) = \sum_{p \in X} d(y, p) \end{align*}
が成り立つ.
\end{prop}
\begin{pf*} 
\begin{align*} \sum_{p \in X} d(x, p) = \sum_{p \in X} d(g^x_y x, g^x_y p) = \sum_{p \in X} d(y, g^x_y p) = \sum_{q \in X} d(y, q)  \end{align*}
\qed
\end{pf*}




\begin{prop}$(X, d)$ を有限な斉次距離空間とする. 任意の$p \in X$ に対して 
\begin{align*} \Mag(X) = \frac{\# X}{\sum_{x \in X} e^{-d(p, x) } }  \end{align*}
が成り立つ.
\end{prop}
\begin{pf*}

\qed
\end{pf*}

\subsection{合併のマグニチュード}

\begin{dfn}(良い射影). $A, B \subset X$ を部分集合とする. $a \in A$ は 
\begin{align*} ^\exists \pi(a) \in A \cap B ; b \in B \naraba  d(a, b) = d(a, \pi (a)) + d(\pi (a), b) \end{align*}
であるとき, $B$ に良く射影される. 任意の点$a \in A$ が$B$ に良く射影される, $A$ は$B$ に良く射影されるという. $A$ が$B$ に良く射影され, $B$ が$A$ に良く射影されるとき, $A, B$ は互いに良く射影されるという. 
\end{dfn}

\begin{remark} $a \in A$ が$B$ に良く射影されるとき, 類似度行列$Z$の成分に関して, 当たり前だが任意の$b \in B$ に対して
\begin{align*} z_{a b} = z_{a \pi(a)} z_{\pi(a) b}\end{align*}
が成り立つ. 
\end{remark}

\begin{prop}(和集合のマグニチュード). $A, B \subset X$ を$X$ の有限部分集合で, $A, B, A \cap B$ がそれぞれウェイト$w^A, w^B, w^{A \cap B}$を持つとする. $A, B$ が互いに良く射影される. 
\begin{align*} w(x) \coloneqq \begin{cases} w^A(x) & x \in A \\ w^A(x) + w^B(x) - w^{A \cap B }(x) & x \in A\cap B \\ w^B(x) & x \in B \end{cases} \end{align*}
と定めると, これは$A \cup B$ のウェイトである. 従って, 
\begin{align*} \Mag(A \cup B) = \Mag(A) + \Mag(B) - \Mag(A \cap B) \end{align*}
が成り立つ. 
\end{prop}
\begin{pf*}実際, $w$ がウェイトになることは例えば類似度行列の$a \in A$ 行目に関しては
\begin{align*} \sum_{x \in X} Z(a, x) w(x) &= \sum_{a^\prime \in A} Z(a, a^\prime) w^A(a^\prime)   + \sum_{b \in B} Z(a, b) w^{B} (b) - \sum_{c^\prime \in A \cap B} Z(a, c) w^{A \cap B} (c)  \\& = \sum_{a^\prime \in A} Z(a, a^\prime) w^A(a^\prime)  \\& \quad + \sum_{b \in B} Z(a, \pi(a)) Z(\pi(a), b) w^{B} (b) - \sum_{c \in A \cap B} Z(a, \pi(a)) Z(\pi(a), c) w^{A \cap B} (c)    \\ 
&= 1 + Z(a, \pi(a)) (  \sum_{b \in B}  Z(\pi(a), b) w^{B} (b)  - \sum_{c \in A \cap B} Z(\pi(a), c) w^{A \cap B} (c) ) \\
&= 1 + Z(a, \pi(a)) (1- 1) = 1
\end{align*}
よりわかる. $b \in B$ 行目に関しても全く同様に示される. さらに, この$\sum_{x \in A \cup B} w(x)$ を計算すると, 主張が従う. 
\qed
\end{pf*}

\begin{prop}($1$点で交わる集合同士の和). $A, B \subset X$ を $1$ 点($c \in A\cap B$ で表す. )で共通部分をもつ有限部分集合とする. $A, B$ がマグニチュードをもち, $A, B$ が互いに良く射影されるとき, $A \cup B$ はメビウス行列をもち, 
\begin{align*} \mu_{A \cup B}( x, y) \coloneqq \begin{cases} \mu^A(x, y)  & x, y \in A, (x, y) \neq  (c, c) \\ \mu^B(x, y)  & x, y \in B , (x, y) \neq  (c, c) \\ \mu^A(c, c) + \mu^B (c, c) - 1 & (x, y) = (c, c)  \\ 0 & \textrm{otherwise} \end{cases} \end{align*}
で与えられる. ただし, $A, B$ のメビウス行列を$M^A = (\mu^A_{ij}), M^B = (\mu^B_{ij})$ で表している. 

\end{prop}
\begin{pf*}実際, 適当に成分を並べて
\begin{align*} &Z^{A\cup B} \paren{ \gyouretsu{ M^A & 0 \\ 0 & 0   } + \gyouretsu{ 0 & 0 \\ 0 & M^B   } - \diag(0, \ldots ,0,  1 , 0, \ldots , 0) }  \\ & =   \gyouretsu{ E & 0 \\ 0 & 0   } +  \gyouretsu{ 0 & 0 \\ 0 & E   } -  \diag(0, \ldots ,0,  1 , 0, \ldots , 0)  = E \end{align*}
と計算できる. 
\qed
\end{pf*}



\subsection{正定値距離空間}


\begin{dfn}(scattered space). 有限距離空間$(X, d)$ は任意の$x, y \in X$ に対して$\log(\# X - 1) < d(x, y)$ を満たす時に, scattered 空間という. 

\end{dfn}


\begin{prop}$(X, d)$ を有限な距離空間とする. $X$ がscattered 空間であるならば, 
$X$ のメビウス行列が存在する. すなわち, $X$ はマグニチュードをもつ. 
\end{prop}
\begin{pf*}$X$ の類似度行列を$Z$ とする. $Z$ が正定値であることを示す. 実数$a,b \in \mathbb R$ に対して
\begin{align*} -\abs a \abs b \leq a b \leq \abs a \abs b \end{align*}
であることに注意すると, 
\begin{align*} x^t Z x = \sum_i x_i^2 + \sum_{i \neq j} x_i z_{i, j} x_j &> \sum_i  x_i^2 - \frac{1}{\# X - 1} \sum \abs{x_i} \abs{x_j} \\ &= (1 - \frac{1}{\# X - 1} )\sum_i x_i^2 + \frac{1}{\# X - 1 } \sum_i  x_i^2 - \frac{1}{\# X - 1} \sum_
{i \neq j} \abs{x_i} \abs{x_j} \\&=    (1 - \frac{1}{\# X - 1} )\sum_i x_i^2 + \frac{1}{2(\# X - 1)} \sum_{i \neq j} (\abs x_i  - \abs x_j )^2 \geq 0 \end{align*}
なので, 半正定値である. また, $x^t Z x = 0$ のとき, $x \neq 0$ であるとすると, 
\begin{align*} 0 = x^t Z x > (1 - \frac{1}{\# X - 1} )\sum_i x_i^2 + \frac{1}{2(\# X - 1)} \sum_{i \neq j} (\abs x_i  - \abs x_j )^2  \end{align*}
となり矛盾するので, $x = 0$ である. 従って, $x^t Z x = 0 \LR x = 0$ が成り立つので, 正定値である. 従って$Z$ は正定値対称行列なので, (固有値が全て正であることから)正則行列であり, 逆行列をもつので, 主張が従う.
\qed
\end{pf*}

\begin{dfn}(正定値距離空間). $(X, d)$ を有限な距離空間とする. $X$ は, 類似度行列が正定値行列であるとき, 正定値距離空間という.

\end{dfn}

\begin{prop}正定値距離空間は, マグニチュードをもつ.

\end{prop}
\begin{pf*}
類似度行列が正定値対称行列なので, 逆行列をもつ. 
\qed
\end{pf*}

\begin{prop}scattered 空間は, 正定値距離空間である.

\end{prop}
\begin{pf*}
前述の命題の証明が, そのまま正定値距離空間であることを示している.
\qed
\end{pf*}

\begin{prop}$2$ 点からなる距離空間は正定値距離空間である. 

\end{prop}
\begin{pf*}
固有値が$1 + e^{-d(p,q)}, 1 - e^{-d(p,q)} > 0$ で与えられる. 
\qed
\end{pf*}

\begin{prop}$3$ 点からなる距離空間は正定値距離空間である. 

\end{prop}
\begin{pf*}類似度行列が
$Z  =\gyouretsu{1 & a & c \\
a& 1 & b \\
c & b& 1 } $ の形である. 主座小行列の行列式が全て正であれば, その行列は正定値であるので, それを調べる. $2$ 次の主座小行列までは正定値であるので, あとは$Z$ 自体の行列式が正であればよい. 
\begin{align*} \det Z  &=1 - a^2 - b^2 - c^2 + 2abc \\&= (1-a)(1-b)(1-c)+ (1-a)(a- bc) + (1-b)(b- ca) + (1-c)(c- ab) \end{align*}
であり, 距離に関する三角不等式から$ab \leq c, bc \leq a, ca \leq b$ であることと, $0 < a, b, c < 1$ であることから, $\det Z > 0$ である.  
\qed
\end{pf*}



\begin{prop}(正定値距離空間のマグニチュードの別の表現). $(X, d)$ を正定値距離空間とする. $X$ の類似度行列を$Z$ で表すことにする. $N = \#X$ とする.
\begin{align*} \Mag X = \max_{v \neq 0} \frac{ (\Sigma v_i )^2 }{v^t Z v}  \end{align*}
が成り立つ.
\end{prop}
\begin{pf*}$Z$ が正定値でることから, 
コーシーシュワルツの不等式より, 任意の$w, v \in \mathbb \mathbb R^N$ に対して
\begin{align*} (w^t Z v) ^2  \leq (w^t Z w)(v^t Z v)  \end{align*}
が成り立つ. $w$ として$X$ のウェイトを代入すると, 任意の$v \in \mathbb R^N$ に対して
\begin{align*} (\Sigma v_i) ^2  \leq \Mag (X) (v^t Z v)  \end{align*}
が成り立つ. 
\qed
\end{pf*}

\begin{remark}
特に断らない限り, 距離空間$(X, d)$ の部分集合には同じ距離$d$ を備えることとする. 
\end{remark}


\begin{prop}(正定値距離空間の部分集合). 正定値距離空間の部分集合は正定値距離空間である. 

\end{prop}
\begin{pf*}
正定値行列の主小行列は正定値(適当に$0$成分を足すことを考えればわかる). 対称行列の主小行列は対称行列である. 故に正定値対称行列の主小行列は正定値対称行列である.  
\qed
\end{pf*}

\begin{prop}$(X, d)$ を正定値距離空間とする. $Y \subset X$ を部分集合とすると, 
\begin{align*} \Mag(Y) \leq \Mag(X). \end{align*}
\end{prop}
\begin{pf*}
$X = \cbra{1, \ldots , N}, Y = \cbra{i_1, \ldots , i_M}$ とし, $X, Y$ の類似度行列をそれぞれ$Z_X, Z_Y$ で表す. $Y$ のウェイトを$w^Y = (w_{i_1}, \ldots , w_{i_M})$ とする. $i = 1,\ldots , N$ に対して, 
\begin{align*} w_i \coloneqq \begin{cases} w_{i_k} & ^\exists k \in \cbra{1, \ldots , M} ; i_k = i \\ 0 & otherwise  \end{cases} \end{align*}
により$w \in \mathbb R^N$ を定める. 
\begin{align*} \Mag(Y) =  \frac{ (\Sigma_k w^Y_{i_k} )^2 }{{w^Y}^t Z_Y w^Y} = \frac{ (\Sigma_i w_i )^2 }{{w}^t Z_X w} \leq \max_{v \neq 0} \frac{ (\Sigma v_i )^2 }{v^t Z_X v} = \Mag(X).  \end{align*}
\qed
\end{pf*}

\begin{prop}$(X, d)$ を正定値距離空間とすると, $1 \leq \Mag(X)$ である.  
\end{prop}
\begin{pf*}
$1$点 という部分集合を考えると, $\Mag(\textrm{1点}) = 1$ であり, もとの空間のマグニチュードは部分集合のマグニチュード以上になることから主張が従う. 
\qed
\end{pf*}

\begin{remark}もちろん, 正定値ではない距離空間の場合, マグニチュードは部分集合のマグニチュード以上であるとは限らない. 仮に部分集合のマグニチュード以上になるとしたら, マグニチュードは$1$ 未満の値をとれないことになる. 
\end{remark}

\begin{prop}(正定値距離空間の$l_1$ 直積). 正定値距離空間の$l_1$ 直積は正定値距離空間である. 

\end{prop}
\begin{pf*}
正定値行列のクロネッカー積は正定値行列である. 
\qed
\end{pf*}

\begin{prop}$2$点距離空間$(\cbra{p, q}, d)$のメビウス行列$M$ に関して次が成り立つ. 
\begin{align*} v^t M v \geq \max \cbra{v_p ^2 , v_q^2 } \quad (\any v \in \mathbb R^2) \end{align*}
\end{prop}
\begin{pf*}
$a \coloneqq e^{-d(p, q)}$ と表すことにすると, $M = \frac{1}{1 - a^2} \gyouretsu{1 & - a \\ - a & 1}$ であるので, 
任意の$v \in \mathbb R^2$ に対して
\begin{align*} v^t M v = \frac{1}{1 - a^2} (v_p^2 + v_q^2 - 2a v_p v_q) . \end{align*}
ここで, $v_p^2 \geq v_q^2$ のときを考えると, 
\begin{align*} \frac{1}{1 - a^2} (v_p^2 + v_q^2 - 2a v_p v_q) - v_p^2 &= \frac{1}{1 - a^2}  (v_p^2 + v_q^2 - 2a v_p v_q - (1-a^2) v_p^2) \\&=  \frac{1}{1 - a^2}  (av_p - v_q) ^2 \geq 0. \end{align*}
$v_p^2 \leq v_q^2$ の時も同じなので主張が従う. 
\qed
\end{pf*}

\begin{prop}\label{2149} $A, B \subset X$ をメビウス行列をもつ有限部分集合とする. $A, B$ が互いに良く射影され, $A \cap B$ が$1$点であるとする. $A, B$ のメビウス行列$M^A, M^B$ に関して
\begin{align*} & v^t M^A v \geq \max_{x \in A }{v(x)^2 } \quad (\any v \in \mathbb R^{\# A}) \\ & v^t M^B v \geq \max_{x \in B }{v(x)^2 } \quad (\any v \in \mathbb R^{\# B}) \end{align*}
が成り立つ時, $A \cup B$ のメビウス行列$M^{A \cup B}$に関して
\begin{align*}  v^t M^{A \cup B} v \geq \max_{x \in A \cup B }{v(x)^2 } \quad (\any v \in \mathbb R^{\# A \cup B})  \end{align*}
が成り立つ. 
\end{prop}
\begin{pf*}
\begin{align*} & v^t \paren{ \gyouretsu{ M^A & 0 \\ 0 & 0   } + \gyouretsu{ 0 & 0 \\ 0 & M^B   } - \diag(0, \ldots ,0,  1 , 0, \ldots , 0) } v \\& \geq \max_{x \in A}  v(x) ^2  + \max_{x \in B} v(x) ^2  - v(c)^2  \\& \geq \max_{x \in A \cup B}  v(x) ^2  \end{align*}
より従う. 最後の不等式は, 例えば$\max_{x \in A \cup B}  v(x) ^2  = \max_{x \in A}  v(x) ^2 $ なら, $\max_{x \in A}  v(x) ^2  + \max_{x \in B} v(x) ^2  - v(c)^2  =\max_{x \in A \cup B}  v(x) ^2 +  (\max_{x \in B} v(x) ^2  - v(c)^2) $ であり, $\max_{x \in B} v(x) ^2  - v(c)^2 \geq 0 $ であることからわかる. 
\qed
\end{pf*}



\begin{prop}実数直線$\mathbb R$ の有限部分集合は正定値距離空間である. 
\end{prop}
\begin{pf*}
実数直線上の有限部分集合を$x_1 < x_2 < \cdots < x_n$ と並べることにする. 
\begin{align*} &\cbra{x_1, x_2, x_3} =  \cbra{x_1, x_2} \cup \cbra{x_2, x_3} \\
&\cbra{x_1, x_2, x_3, x_4} =  \cbra{x_1, x_2, x_3} \cup \cbra{x_3, x_4} \\ 
& \vdots 
\end{align*}
のように, 互いに良く射影される集合の合併を, 共通部分が$1$ 点となるように繰り返しとることを考える. すると, 命題\ref {2149} が適用できる状況を繰り返していることになるので, 主張が従う. 
\qed
\end{pf*}

\begin{prop}ユークリッド空間に$l^1$ 距離を備えた距離空間$(\mathbb R^n, d_{l^1})$ の有限部分集合は正定値距離空間である. 

\end{prop}
\begin{pf*}
有限部分集合$\cbra{(x^1_1, \ldots, x^1_n)  , (x^2_1, \ldots, x^2_n), \ldots, (x^N_1, \ldots, x^N_n)}$ は
\begin{align*} X \coloneqq \cbra{(p_1, \ldots , p_n) \mid p_i \in \cbra{x^1_i, x^2_i, \ldots, x^N_i}, i = 1, \ldots, n } \end{align*}
の部分集合でもある. 正定値距離空間の$l^1$ 直積は正定値距離空間であることと合わせると, これは正定値距離空間の部分集合であるので, 正定値距離空間である. 
\qed
\end{pf*}

\subsection{コンパクト距離空間のマグニチュード}

\begin{dfn}$(X, d)$ をコンパクト距離空間とする. 
\begin{align*} \Mag(X) \coloneqq \sup \cbra{\Mag(A) \mid A \textrm{は} X \textrm{の有限部分集合}}\end{align*}
によりコンパクト距離空間のマグニチュードを定める. 
\end{dfn}

\begin{prop}(区間のマグニチュード). 有界閉区間$[a, b] \subset \mathbb R$ のマグニチュードは
\begin{align*} \Mag ([a,b]) = 1 + \frac{b -a}{ 2}  \end{align*}
で与えられる. 
\end{prop}
\begin{pf*} 

\qed
\end{pf*}




















\subsection{非コンパクト距離空間のマグニチュード}

\begin{dfn}(正定値距離空間とウェイト空間). $(X, d)$ を距離空間とする. $(X, d)$ 上の台が有限集合である符号付き有限測度全体を$FM(X, d)$ で表す. $FM(X)$ に双線形形式を
\begin{align*} \tbra{\mu, \nu} \coloneqq \int_{X \times X} e^{-d(x,y)} d\mu d\nu \end{align*}
により定める. この双線形形式が正定値(つまり内積になる)とき, $(X, d)$ をPDMS(正定値距離空間)という. 
また, $X$ がPDMSであるときに, この内積が定めるノルムに関して$FM(X)$ を完備化した空間を$\mathcal W_X$ で表し, $X$ のウェイト空間という. コンパクト集合$A \subset X$ に対しては, $\mathcal W _A $ で, $FM(A)$ の$\mathcal W_X$ における閉包を表す. 
\end{dfn}

\begin{prop}$(X, d)$ をPDMS, $x, y \in X$ とする.  \\
(1)$\norm{\delta_x}_{\mathcal W} = 1$ \\
(2)$\norm{\delta_x  - \delta_y}_{\mathcal W} = 2(1 - e^{-d(x, y)})$ \\
(3)$\norm{\delta_x  - \delta_y}_{\mathcal W} \leq \sqrt{2 d(x, y)}$
が成り立つ.
\end{prop}
\begin{pf*}
(1)$ \norm{\delta_x}_{\mathcal W}^2  = \int e^{-d(p,q)} d\delta_x(p) d \delta_x(q) = e^{-d(x,x)} = 1 $. (2)普通に計算. (3)$1+x \leq e^{x}$ っていうよく知られた不等式を使う. 
\qed
\end{pf*}


\begin{dfn}(ヘルダー連続). $(X, d)$ 上の連続関数で
\begin{align*} \abs{fx - fy} \leq C \sqrt{d(x, y)} \quad (x, y \in X) \end{align*}
を満たすものを, $1/2$ ヘルダー連続関数といい, $C^{1/2}(X)$ で表す. 
\end{dfn}

\begin{setting}$C^{1/2}(X)$ に
\begin{align*} \norm{f}_{C^{1/2}} \coloneqq \max \cbra{\norm{f}_\infty, \sup_{x, y \in X, x \neq y} \frac{\abs{fx - fy}}{\sqrt{2d(x, y)}} } \end{align*}
でノルムを定める. 
\end{setting}

\begin{prop}$(X, d)$ を距離空間とする. $x, y, p \in X$ に対して, 
\begin{align*} e^{-d(x, p)} - e^{-d(y, p)} \leq d(x, y)\end{align*}
が成り立つ. 
\end{prop}
\begin{pf*}
$e^{-d(x, p)} - e^{-d(y, p)} = e^{-d(x, p)}(1 - e^{-(d(y, p) - d(x, p) )   }) \leq 1 \cdot ( d(y, p) - d(x, p) )  \leq d(x, y) .$
\qed
\end{pf*}


\begin{notation}$\mu \in FM$ に対して, 
\begin{align*} Z\mu(x) \coloneqq \int e^{-d(x,y)} d\mu(y)\end{align*}
という記号を導入する. 
\end{notation}

\begin{prop}$\nu \in FM(X), x \in X$ に対して
\begin{align*} Z\mu(x) = \tbra{\mu, \delta_x} \end{align*}
が成り立つ. 
\end{prop}
\begin{pf*}
定義から直ちにわかる. 
\qed
\end{pf*}



\begin{prop}$\mu \in \mathcal FM$ とする. $Z \mu \in C^{1/2}$ かつ, $\norm{Z \mu}_{C^{1/2}} \leq \norm{\mu}_{\mathcal W}$ が成り立つ. 

\end{prop}
\begin{pf*}
$\abs{Z \mu (x)} = \abs{\tbra{\mu, \delta_x}} \leq \norm \mu \norm {\delta_x} = \norm \mu$ より, $\norm{Z\mu}_\infty \leq \norm \mu$ が成り立ち, 
\begin{align*} \abs{Z \mu (x) - Z \mu (y)} = \abs{\tbra{\mu, \delta_x - \delta_y}} \leq \norm \mu \norm{\delta_x - \delta_y} \leq \norm \mu \sqrt{2 d(x, y) }\end{align*}
より, $\sup_{x \neq y} \frac{\abs{Z\mu (x) - Z \mu(y)}}{\sqrt{2d(x, y)}} < \norm \mu$
が成り立つ. 
\qed
\end{pf*}

\begin{prop}(BLT定理). ノルム空間$X$ からバナッハ空間$Y$への有界線型作用素は, $X$ の完備化$\bar X$ から$Y$ への有界線型作用素に作用素ノルムを変えずに一意に拡張できる.

\end{prop}
\begin{pf*}
よく知られた事実である. 
\qed
\end{pf*}

\begin{prop}$(X,d)$ をPDMSとする. $Z: FM(X) \rightarrow C^{1/2}(X)$ は, 有界線型作用素$Z: \mathcal W_X \rightarrow C^{1/2}$ に一意に拡張でき, 次の(1)(2)を満たす. \\
(1)$\norm Z = 1.$ \\
(2)$w \in \mathcal W, \mu \in FM \naraba \tbra{w, \mu}_\mathcal W = \int Zw d\mu.$ \\
(3)$Z$ は単射である. 
\end{prop}
\begin{pf*} 一意に拡張できることは, BLT定理より従う. (1)は$1 = \norm{Z \delta_x}_\infty \leq \norm{Z \delta_x}_{C^{1/2}} \leq \norm{\delta_x}_{\mathcal W} = 1$ より従う. (2)は$w_i \in FM, w_i \rightarrow w \in \mathcal W$ を考えることで従う. (3)$Zw = 0$ なる$w \in \mathcal W$ をとる. $0 = Zw(x) = \tbra{w, \delta_x}$ より, 線形性から任意の$\mu \in FM$ に対して$\tbra{w, \nu} = 0$ が成り立つ. $FM$ は$\mathcal W$ で稠密なので, $\tbra{w, w} = 0$ となり, 主張が従う. 
\qed
\end{pf*}


\begin{dfn}(PDMSのマグニチュード). $(X, d)$ をPDMSとする. $A \subset X$ をコンパクトとする. $w \in \mathcal W_A$ で
$Zw(a) = 1 \quad (\any a \in A)$ を満たすものを, $A$ のウェイトという. $X$ がウェイトをもつとき, $X$ はマグニチュードをもつといい, 
\begin{align*} \Mag(A) \coloneqq \norm{w} _{\mathcal W} ^2\end{align*}
と定め, これを$A$ のマグニチュードという. $(X, d)$ がPDMSであれば$Z$ が単射であることから, $X$ はただ一つのウェイトしかもたないことに注意しておく. 
\end{dfn}




\begin{setting}$(X, d)$がPDMSのとき, $\mathcal H = Z(\mathcal W) \subset C^{1/2}(X)$ を考えると, $Z$ が単射であったことから, $Z: \mathcal W \rightarrow \mathcal H$ は全単射である. 
\begin{align*} \tbra{f, g}_{\mathcal H} \coloneqq \tbra{Z^{-1}f, Z^{-1}g}_{\mathcal W} \end{align*}
により$\mathcal H$ に内積を定める. 当然, $Z$ は全単射等長写像となる. 
\end{setting}

\begin{remark}
$X = \mathbb R^n$ を考えているときには, ウェイト空間は$H^{-(n+1)/2}$ と一致し, $\mathcal H$ は$H^{(n+1)/2}$ と一致する. 
\end{remark}





\begin{dfn}(ベッセルポテンシャル空間). 
\begin{align*} H^\alpha \coloneqq \cbra{ \varphi \in S^\prime (\mathbb R^n) \mid (1 + \norm{\cdot} ^2) ^{\alpha/2} \hat \varphi \in L^2(\mathbb R^n)}  \end{align*}
に
\begin{align*} \norm{\varphi }_{H^\alpha} \coloneqq \sqrt{ \int_{\mathbb R^n} (1 + \norm \xi ^2) ^\alpha \abs{\hat \varphi(\xi)} ^2 d\xi }  \end{align*}
でノルムを定める. 
\end{dfn}

\begin{prop}ベッセルポテンシャル空間はヒルベルト空間である. 

\end{prop}
\begin{pf*}

\qed
\end{pf*}


\begin{prop} $p \in \mathbb R^n$ とする. $\alpha \leq -1$ ならば, 

\begin{align*} \delta_p \in H^{\alpha}(\mathbb R^n) \end{align*}

\end{prop}
\begin{pf*}
$\delta_p \subset S^\prime (\mathbb R^n)$ であり, フーリエ変換は$\frac{1}{(2\pi)^{n/2}}e^{-i p x}$ である. 
\begin{align*} \int_{\mathbb R^n} \abs{ \frac{1}{(1 + \norm x ^2) ^\alpha}\frac{1}{(2\pi)^{n/2}} e^{-i p x}    } dx \leq \frac{1}{(2\pi)^{n/2}}  \int_{\mathbb R^n} \frac{1}{(1 + \norm x ^2) ^\alpha}  dx < \infty \end{align*}
\qed
\end{pf*}


\begin{prop}(ポテンシャルの下限による表示). 

\end{prop}
\begin{pf*}

\qed
\end{pf*}



\begin{notation}ノルム空間$(X, \norm )$ に対して, 
\begin{align*} \zeta(x) \coloneqq e^{-\norm{x}} \end{align*}
と定める. 
\begin{align*} \hat \zeta (\xi) = \frac{1}{(2\pi)^{n/2}} n! \omega_n (1 + \norm \xi ^2)^{-(n+1)/2} \end{align*}
が成り立つ. 
\end{notation}

\begin{prop}(1)$FM \subset  H^{-(n+1)/2} $ である. \\
(2)包含写像$FM \rightarrow H^{-(n+1)/2} $ は全単射$\mathcal W \rightarrow H^{-(n+1)/ 2}$ に拡張される. また, 任意の$\mu \in FM$ に対して$\norm{\mu}_{\mathcal W} = \sqrt{n ! \omega_n} \norm{\mu}_{H^{(n+1)/2}}$ が成り立つ. 

\end{prop}
\begin{pf*}



\begin{align*} 
n! \omega _n \norm{\mu}^2_{H^{-(n+1)/2}} 
&= n! \omega _n \int (1 + \norm \xi ^2) ^{-(n+1)/2} \abs{\widehat \mu (\xi)}^2 d \xi
\\&= (2 \pi )^{n/2} \int \hat \zeta (\xi) (\hat \mu (\xi))^2 d\xi 
\\&= (2 \pi )^{n/2} \int \hat \zeta (\xi) (\sum c_k \widehat{\delta_{x_k}} (\xi))^2 d\xi 
\\&= (2 \pi )^{n/2} \int \hat \zeta (\xi) (\sum c_k \overline{c_l}  \paren{\frac{1}{(2\pi)^{n/2}}}^2 e^{- i x_k \xi} e^{ + i x_l \xi }  ) d\xi 
\\&= \frac{1}{(2 \pi )^{n/2}} \sum c_k \overline{c_l}  \int \hat \zeta (\xi)  e^{- i (x_k - x_l) \xi}   d\xi 
\\&=\frac{1}{(2 \pi )^{n/2}} \sum c_k \overline{c_l}  \int \hat \zeta (\xi)  e^{i (x_l - x_k) \xi}   d\xi 
\\&=  \sum c_k \overline{c_l}  \zeta (x_l - x_k)  
\\&= \int e^{-d(x, y)} d\mu d\bar \mu
\\& = \norm{\mu}^2_{\mathcal W}  
\end{align*}
が成り立つ. 
\qed
\end{pf*}













\subsection{その他の話題}

\begin{prop}$X \subset \mathbb R^2$ を滑らかなコンパクト領域とする. 
\begin{align*} M_X (r) = M_B (r) + o(r) \quad (r \rightarrow \infty ) \end{align*}
が成り立つとき, $X$ は単位閉球に等長同型である. 

\end{prop}
\begin{pf*}
\begin{align*}&n! \omega_n M_X (r) = \vol_n (X) r^2 + \frac{2 + 1}{2} \vol_1 (\partial X) r + o(r) \\ 
&n! \omega_n M_B (r) = \vol_n (B) r^2 + \frac{2 + 1}{2} \vol_1 (\partial B) r + o(r) 
\end{align*}
より, $M_X (r) = M_B (r) + o(r) \quad (r \rightarrow \infty ) $ とすると$\vol_2 (X) = \vol_2 (B), \vol_1 (\partial X) = \vol_1 (\partial B)$ が成り立つ. 等周不等式を考えると, $X$ は$B$ に等長同型である. 
\qed
\end{pf*}







\subsection{2マグニチュード}

\begin{screen}
2マグニチュードはほとんどの場合で退化していて使い物にならない. 
\end{screen}

\begin{dfn}(2マグニチュード). 

\end{dfn}

\begin{dfn}$(X, d)$ をPDMSとする. $FM$ に内積を, 
\begin{align*} (\mu, \nu) \coloneqq \int e^{-\frac{d^2(x,y)}{2}} d\mu(x) d\nu(y)  \end{align*}
で定める. $FM$ をこの内積が定めるノルムに関して完備化したものを, $\mathcal W$ で表すことにする. 
\end{dfn}

\begin{prop}距離空間$(X, d)$ のリプシッツ関数全体$\Lip(X)$に
\begin{align*} \norm f \coloneqq \max \cbra{ \norm{f}_\infty     , \sup_{x \neq y} \frac{\abs{f(x) - f(y)}}{d(x, y)}  }  \end{align*}
と定めると, これはノルムとなり, $(Lip(X), \norm \cdot)$ は完備である. 
\end{prop}
\begin{pf*}ノルムとセミノルムの$\max$ なので, ノルムであることは直ちにわかる. 
\begin{align*} \frac{1}{2}( \norm{f}_\infty  +   \sup_{x \neq y} \frac{\abs{f(x) - f(y)}}{d(x, y)} )  \leq \max \cbra{ \norm{f}_\infty, \sup_{x \neq y} \frac{\abs{f(x) - f(y)}}{d(x, y)}  } \leq  \norm{f}_\infty  +   \sup_{x \neq y} \frac{\abs{f(x) - f(y)}}{d(x, y)}    \end{align*}
が成り立っている. $\norm{f}_\infty  +   \sup_{x \neq y} \frac{\abs{f(x) - f(y)}}{d(x, y)} $ に関して完備性を示すことにする. 適当にコーシー列をとると, $\norm \cdot _\infty$ に関してコーシー列になっている. $L_\infty$ が完備であることの証明とほとんど全く同様に, $\norm \cdot _\infty $ に関して収束列であることが示せる. 収束先を$f$ で表す. 
\begin{align*} \frac{\abs{f(x) - f(y)}}{d(x, y)} \leq \frac{\abs{f(x) - f_n(x)} + \abs{f_n(x) - f_n(y)} + \abs{f_n(y) - f (y)} }{d(x, y)}                              \end{align*}
が成り立つことを用いると主張が従う. 
\qed
\end{pf*}

\begin{prop}$\mu \in FM \naraba Z\mu  \in \Lip$

\end{prop}
\begin{pf*}
通常のマグニチュードの時と同様の手順で, 
\begin{align*} \norm{Z\mu (x) - Z \mu (y)} \leq \norm{\mu} d(x, y) \end{align*}
が示せる. 
\qed
\end{pf*}

\begin{prop}$\mu \in FM(A)$ に対して, $x \in A^c \naraba Z\mu (x) = 0 $ が成り立つ. 
\end{prop}
\begin{pf*}

\qed
\end{pf*}

































\section{マグニチュードホモロジー}




















\section{凸}



\subsection{凸体に関する基本事項}





\begin{dfn}(凸体). $A \subset \mathbb R^n$ は, 空でなく, コンパクトかつ凸であるとき, 凸体という. また, 凸体全体の集合を$\mathcal K^n$ で表す.

\end{dfn}

\begin{prop}(凸体とミンコフスキー和) 
\begin{align*} K, L \in \mathcal K ^n \naraba K + L \in \mathcal K ^n \end{align*}
が成り立つ.
\end{prop}
\begin{pf*}空でないことは明らか. 
\begin{claim}
$K + L$ はコンパクトである. 
\end{claim}
\begin{claimproof}
点列$z_n = x_n + y_n \in K+ L$ をとると, $x_n, y_n$ はそれぞれ収束部分列をもつので, $z_n$ も収束部分列をもつ.  
\end{claimproof}

\begin{claim}
$K + L$ は凸集合である. 
\end{claim}
\begin{claimproof}
$t(x_0 + y_0) + s(x_1 + y_1) = (t x_0 + s x_1) + (t y_0 + s y_1).$ 
\end{claimproof}
\qed
\end{pf*}

\begin{prop}次が成り立つ.
\begin{align*} K \in \mathcal K ^n, \alpha \in \mathbb R \naraba \alpha K \in \mathcal K ^n. \end{align*}
\end{prop}
\begin{pf*}
$t(\alpha x_0) + s(\alpha x_1) = \alpha (t x_0 + s x_1).$
\qed
\end{pf*}

\begin{dfn}(凸錐). $C \subset \mathbb R^n$ は, 任意の$x \in C$ と任意の実数$a > 0$ に対して$ax \in C$ が成り立つとき, 凸錐という. 

\end{dfn}

\begin{remark}$\mathcal K ^n$ 自体, 冪集合において, 凸錐である. 

\end{remark}


\begin{dfn}(支持関数). $K \in \mathcal K^n$ とする. 
\begin{align*} h_K: \mathbb R^n \rightarrow \mathbb R; x \mapsto \sup_{y \in K} (y, x)\end{align*}
を$K$ の定める支持関数という. 
\end{dfn}

\begin{remark}
$K$ はコンパクトであるので, $x$ ごとに最大値を実現する元が存在するので, 右辺は常に$\max_{y \in K}(x, y)$ である. 
\end{remark}

\begin{remark}冷静に考えるとわかるが, $u \in S^{n-1}$ 単位ベクトルをとれば, $h_K(u)$ は原点から$u$ 方向に進んで行った時の, $K$ の$u$ 方向の端っこまでの距離である. 


\end{remark}


\begin{prop}$y \in \mathcal K$ が$\sup_{y \in K}(x, y)$ のmaximizerであるならば, $y \in \partial K$
\end{prop}
\begin{pf*}
$y \in K$ を$h_K$ のmaximizerとする. $y$ が$K$ の内点であるとする(背理法). 十分小さい$\veps > 0$ をとると, $y + \veps x \in K$ である. 
\begin{align*} (x, y + \veps x) > (x, y)  \end{align*}
となるので矛盾する. 
\qed
\end{pf*}

\begin{remark}この命題をみてると, 大体$K$ の中をまだ$x$ 方向に進んでいけるような状態だと, $(x, y)$ という量はまだ増やせる. 従って, $x$ と直交する超平面を考えて, $x$ 方向にその超平面を並行に動かしていったとき, ぎりぎり$K$ と交点をもつような瞬間を想像すればよい. 

\end{remark}




\begin{dfn}(半空間). 部分集合$H^{\geq} \subset \mathbb R^n$ は, $a \in \mathbb R^n, b \in \mathbb R$ で
\begin{align*} (a, x) \geq b \quad (x \in H)\end{align*} 
を満たすものが存在するとき, 半空間という. 
\end{dfn}

\begin{prop}半空間は凸集合である.

\end{prop}
\begin{pf*}
$(a, tx_0 + s x_0) \geq tb + sb = b.$
\qed
\end{pf*}

\begin{dfn}(支持超平面). $K \in \mathcal K^n$, $h_K$ を$K$ の定める支持関数, $u \in S^{n-1}$ とする. 
\begin{align*} H(K; u) \coloneqq \cbra{x \in \mathbb R^n \mid (x, u) = h_K (u) } \end{align*}
と定めこれを支持平面という. 
\begin{align*}  &H^{>} (K; u) \coloneqq \cbra{x \in \mathbb R^n \mid (x, u) > h_K (u) }  \\
&H^{\geq} (K; u) \coloneqq \cbra{x \in \mathbb R^n \mid (x, u) \geq h_K (u) } \\
&H^{<} (K; u) \coloneqq \cbra{x \in \mathbb R^n \mid (x, u) < h_K (u) } \\
&H^{\leq} (K; u) \coloneqq \cbra{x \in \mathbb R^n \mid (x, u) \leq h_K (u) } 
  \end{align*}
という記号も導入しておく. 
\end{dfn}

\begin{dfn}(凸多面体). $P \subset \mathbb R^n$ は, 有限個の半空間の族$\cbra{H^{\leq}_i}$ で, $P = \bigcap H^{\leq}_i$ を満たすものが存在するとき, 凸多面体という. 凸多面体全体を$\mathcal P ^n$ で表す. 
\end{dfn}


\begin{notation}有限個の族だけでなく, 無限個の族を許すと, 多分凸体全体と一致する. 有限個の頂点の凸包として定義する場合もあるが, その場合は半空間などは凸多面体に含まないことになる. 

\end{notation}

\begin{dfn}(凸多面体の面). $P \in \mathcal P^n$ が半空間$\cbra{H^\leq _1, \ldots, H^\leq _N}$に対して$P = \bigcap H^{\leq}_i$ と表されているとする. 各, $H^\leq_i$ に対して, $u_i \in S^{n-1}$ で
\begin{align*} H^\leq_i =  H^{\leq} (K; u_i) \end{align*}
を満たすものがとれるので, 
\begin{align*} P(u_i) \coloneqq P \cap H^{\leq} (K; u_i) \end{align*}
と定めて, これを$u_i$ 方向の面という. 
\end{dfn}


\begin{dfn}(相対的内部). 部分集合$A \subset \mathbb R^n$ に対して, $\textrm{relint} A$ で, $A$ のアファイン包の内部を表し, これを$A$ の相対的内部という. 

\end{dfn}

\begin{prop}
(1)任意の$K \in \mathcal K ^n$ と任意の$\veps > 0$ に対して, $P \in \mathcal P^n$ で, $P \subset K$ かつ, $d_H(K, P) \leq \veps$ を満たすものが存在する. \\
(2)任意の$K \in \mathcal K ^n$ と任意の$\veps > 0$ に対して, $P \in \mathcal P^n$ で, $K \subset P$ かつ, $d_H(K, P) \leq \veps$ を満たすものが存在する.  \\
(3)$K \in \mathcal K ^n$ は, $0 \in \textrm{relint}K$ を満たすならば, 任意の$\veps > 0$ に対して$P \in \mathcal P^n$ で, $P \subset K \subset (1 + \veps) P$ を満たすものが存在する. 

\end{prop}
\begin{pf*}
(1)$\bigcup_{x \in \partial K} B(x; \veps) \cup \textrm{int} K$ は $K$ の開被覆なので, $K$ がコンパクトであることから有限部分被覆がとれる. 従って, $\partial K$ は 有限個の開球$B(x_1; \veps), \ldots B(x_N; \veps)$ で被覆できる. $x_1, \ldots , x_N$ の凸包を$P$ とすると, これが求める凸多面体である. (実際, $P_\veps = P + B(\veps)$ は$\partial K$ を含む凸集合であり, 任意の点$x \in \textrm{int} K$ は適当に$x$ を通る直線を考えた時に, その直線は$\partial K$ と交点を2つもって, その交点は凸集合である$P_\veps$ に含まれているので, $2$ 点を結ぶ線分上にある$x$ も$P_\veps$ に含まれる.) \\
(2)
\qed
\end{pf*}

\subsection{内在的体積}

\begin{remark}
凸多面体として, 有界なもののみを考えることとする. 
\end{remark}

\begin{notation}$u \in S^{n -1}$ に直交し, 原点を通る超平面$u^\perp$ への正射影を
\begin{align*} \pi^\perp_u : \mathbb R^n \rightarrow u^\perp \end{align*}
で表す. 
\end{notation}

\begin{dfn}(凸多面体の内在的体積). $\mathcal P^n$ 上の関数 $V_1, \ldots, V_n$ を帰納的に定義していく. \\
(1)$P \in \mathcal P^1$ に対しては, 
\begin{align*} V_1 (P) \coloneqq b - a \end{align*} 
と定める. \\
(2)$P \in \mathcal P^n$ に対しては, 
\begin{align*} V_n (P) \coloneqq \begin{cases} \frac{1}{n} \sum_{u \in S^{n-1}; u\textrm{方向の面が存在}} h_P(u) V_{n-1}(\pi^\perp_u P(u)) & \dim P = n-1, n \\ 0 &   \dim P \leq n-2 \end{cases} \end{align*}

\end{dfn}

\begin{remark}
例えば, $\mathbb R^2$ の中の$u \in S^1$ に直交する線分$L$は$4$つの半平面の共通部分で表される凸多面体で, $\dim L = 1$ であるが, 試しに$V_2 (L)$ を計算してみると, $u$ 方向の面と$-u$ 方向の面があるので, それらに関する項が打ち消しあって, (残り$2$ 方向分は, 射影すると$1$ 点になる方向なので, それらの$V_1$ に関する値は$0$ になる) 結局$0$ になる. 
\end{remark} 



\begin{prop}$P \in \mathcal P ^n$ に対して, 
\begin{align*} V_n (P) = \textrm{Leb}_n (P) \end{align*}
が成り立つ. 
\end{prop}
\begin{pf*}

\qed
\end{pf*}


\begin{prop}任意の$K \in \mathcal K^n$ に対して
\begin{align*} \sup_{P \subset K, P \in \mathcal P^n} V_n (P) = \inf_{K \subset P, P \in \mathcal P^n} V_n (P)  \end{align*}
が成り立つ. 
\end{prop}
\begin{pf*}$V_n$ は剛体運動に関して不変であるので, $0 \in \textrm{relint} K$ となるように$K$ を動かしておく. すると, 任意の$\veps >0$ に対して 
\begin{align*} P \subset K \subset (1 + \veps) P\end{align*}
を満たす$P \in \mathcal P^n$ がとれる.  
\qed
\end{pf*}

\begin{dfn}(凸体の内在的体積). $K \in \mathcal K^n$ に対して
\begin{align*} V_n (K) \coloneqq  \sup_{P \subset K, P \in \mathcal P^n} V_n (P)  \paren{ = \inf_{K \subset P, P \in \mathcal P^n} V_n (P) }  \end{align*}
と定める. 
\end{dfn}

\begin{dfn}(多面体の混合体積). $n$ 次元ユークリッド空間$\mathbb R^n$ の部分集合である$n$ 個の凸多面体$P_1, \ldots , P_n \in \mathcal P^n$ に対して, $V_i(P_1, \ldots, P_n) \quad ( i = 1, \ldots , n)$ を帰納的に定義していく. \\
(1)$n = 1$ のとき, 
\begin{align*} V_1(P_1) \coloneqq b-a.\end{align*}
(2)$n \geq 2 $ のとき, 
\begin{align*}V_n (P_1,\ldots , P_n) \coloneqq \sum_{\star} h_{P_n} (u) V_{n-1} (\pi^\perp_u P_1 (u) ,  \ldots ,\pi^\perp_u P_{n-1} (u))  \end{align*}
ただし, $\star$ は, $P_1 + \cdots P_{n-1}$ について$u \in S^{n-1}$ 方向の面が存在するすべての$u$ をはしる. 
\end{dfn}







\section{不変測度}


\begin{dfn}(不変測度). 位相群$G$ 上のボレル測度$\nu$で,  任意の$A \in \mathcal B (G)$ に対して
\begin{align*} \nu(gA) = \nu(A) \quad (\any g \in G)\end{align*}
を満たすものを, 左不変測度という. 
\begin{align*} \nu(A) = \nu(Ag) \quad (\any g \in G)\end{align*}
を満たすものを, 右不変測度という. 
\begin{align*} \nu(A) = \nu(A^{-1}) \end{align*}
を満たすものをinverse 不変測度という. また, 左不変かつ右不変かつinverse 不変な測度を不変測度という.
\end{dfn}

\begin{dfn}(ハール測度). 位相群$G$ 上のコンパクト集合に対して有限な測度を定めるボレル測度$\nu$で, 左不変かつ正則なものを左ハール測度という. また, 右不変かつ正則なものを右ハール測度という. 左不変かつ右不変かつ正則なものをハール測度という.

\end{dfn}

\begin{dfn}(積分左不変). $G$ を位相群, $\nu$ を$G$ 上の測度, $\mathcal F$ を可測関数の族とする. 任意の$f \in \mathcal F$ に対して
\begin{align*} \int_G f (hg) d \nu(g) = \int_G f (g) d\nu(g) \quad (\any h \in G)\end{align*}
が成り立つ. とき, $G$ は$\mathcal F$ に関して積分左不変であるという.
\end{dfn}



\begin{prop} $G$ を位相群, $\nu$ を$G$ 上の左不変測度とすると, $G$ は可測関数に関して積分左不変である.
\end{prop}
\begin{pf*}
\begin{align*} h^{-1} A = \cbra{x \in G \mid hx \in A} \end{align*}
であることから, 
\begin{align*} g \in h^{-1}A  \LR hg \in A \end{align*}
であるので, 
\begin{align*} \int_G 1_A (hg) d\nu(g) &= \nu(\cbra{g \in G \mid hg \in A}) \\ 
&= \nu(\cbra{g \in G \mid g \in h^{-1}A }) \\
&= \nu(h^{-1}A) = \nu (A) = \int_G 1_A (g) \nu(g) 
\end{align*}
より, 定義関数に対しては成り立つ. 従って, 任意の非負可測関数に対して成り立つ.
\qed
\end{pf*}

\begin{prop} $G$ を位相群, $\mathcal F$ を可測関数の族, $\nu$ を$G$ 上の$\mathcal F$ に関して積分左不変な測度とする. このとき, 任意の$f \in \mathcal F, h \in G$ に対して
\begin{align*} \int_G f(g^{-1} h)d\nu(g) = \int_{G} f(g^{-1}) d\nu(g)  \end{align*}
が成り立つ. 
\end{prop}
\begin{pf*}
\begin{align*} \int_G f(g^{-1} h)d\nu(g) =\int_G f((h^{-1} g)^{-1} ) d\nu(g) = \int_{G} f(g^{-1}) d\nu(g).  \end{align*}
\qed
\end{pf*}

\begin{prop}$G$ を位相群, $\nu$ を$G$ 上の測度とする. $C_c (G; \mathbb R_{\geq 0})$ に関して積分左不変であるならば, 左不変測度である.

\end{prop}
\begin{pf*}

\qed
\end{pf*}


\begin{prop}逆不変測度であることと, 非負$C_c(G)$ に関して積分逆不変であることは必要十分である.

\end{prop}
\begin{pf*}

\qed
\end{pf*}



\begin{prop}第二可算なコンパクト群$G$ 上の左ハール測度$\nu$ は不変測度である.
\end{prop}
\begin{pf*}$\nu(G) = 1$ となるように正規化しておく.  任意の非負連続関数$f$ に対して, 
\begin{align*} \int_G f(g^{-1}) d\nu(g) = \int_G \int_G f(g^{-1} h) d\nu(g) d\nu(h)
 = \int_G \int_G f(g^{-1} h) d\nu(h) d\nu(g) = \int_G f(h) d\nu(h)  \end{align*}
 となり, $C(G; \mathbb R_{\geq 0}) $ に関して積分逆不変性が成り立つ. $G$ はコンパクトなので, $C(G; \mathbb R_{\geq 0}) = C_c (G; \mathbb R_{\geq 0})$ であるので, 前述の命題から, $\nu$ は逆不変である. また, 任意の連続関数$f \in C(G)$ に対して
 \begin{align*}  \int_G f(gh) d\nu (g) = \int_G f(g^{-1}h) d\nu(g) = \int_G f(g^{-1}) d\nu(g) =  \int_G f(g) d\nu(g) \end{align*}
 より右不変でもある.
\qed
\end{pf*}


\begin{notation}(あとで消す). $(G, \nu)$ コンパクト第二可算ハウスドルフ連続推移的, ハール確率測度. 
$(E, \alpha, \rho)$ 第二可算ハウスドルフ, 局所有限ボレル測度, 

\end{notation}

\begin{remark}(あとで消す). $(G, \nu)$ コンパクトリー群ハール確率空間. $(E, \alpha, \rho)$ 多様体, 自明でない局所有限ボレル測度, 局所有限ボレル測度. 

\end{remark}


\begin{prop}$G$ をハウスドルフ空間$E$ に連続かつ推移的に作用するコンパクト群とする. $G, E$ は可算開基をもつ. $\nu$ を$G$ 上のハール確率測度とする. $\rho \neq 0, \alpha $ を$E$ 上の局所有限ボレル測度とする. $\rho$ が$G$不変であるならば, 任意の$A, B \in \mathcal B (E) $ に対して
\begin{align*} \int_G \alpha(A \cap gB) d\nu(g) = \alpha (A) \rho(B) / \rho (E)  \end{align*} 
が成り立つ. 
\end{prop}
\begin{pf*}




\qed
\end{pf*}

\begin{prop}$G$ を集合$X$ に作用する群とし, $B \subset X, h \in G$ とする. このとき, 
\begin{align*} \cbra{hg \in G \mid gp \in B } = \cbra{f \in G \mid fp \in hB }\end{align*}
\end{prop}
\begin{pf*}
\begin{align*} hg \in \textrm{左} \naraba h(gp) \in hB , \quad
fp \in \textrm{右} \naraba h^{-1} fp \in B
\end{align*}
\qed
\end{pf*}



\begin{prop}($G$不変ボレル測度の一意的存在). $G$ をコンパクト群, $\nu$ をハール確率測度とする. (満たされがちな, ある程度良い条件を仮定する. すなわち, $G$ の作用は連続かつ推移的, $G, E$ は第二可算ハウスドルフ空間である. ) このとき, $p \in E$ を適当な点として, 
\begin{align*} \rho(B) \coloneqq \nu (\cbra{g \in G \mid gp \in B})      \quad (B \in \mathcal B (E) ) \end{align*}

は$E$ 上の$G$ 不変ボレル確率測度である. 
\end{prop}
\begin{pf*}(一意性は工事中). 
\begin{align*} \rho(B) &= \nu (  \cbra{g \in G \mid gp \in B}   ) = \nu(h  \cbra{g \in G \mid gp \in B} )   \\
&= \nu(  \cbra{h g \in G \mid gp \in B} ) = \nu(  \cbra{f \in G \mid fp \in hB} ) 
\end{align*}

\qed
\end{pf*}

\begin{remark}推移性は点$p$ のとりかたに依らないところに効いてくる? 

\end{remark}

\begin{prop}回転群$SO_d$ にはハール確率測度が一意に存在する.

\end{prop}
\begin{pf*}
回転群と運動群のハール測度, のpdf参照.
\qed
\end{pf*}
















\section{グラフ上の熱方程式}

\begin{dfn}(グラフラプラシアン).
\begin{align*} L \coloneqq D - A, \quad \mathcal L \coloneqq I - A D^{-1}\end{align*}
をそれぞれ, グラフラプラシアンとランダムウォーク正規化グラフラプラシアンという. 
\end{dfn}

















\section{失敗集}

\subsection{測度距離空間におけるウェイトの定義}

$(X, d, \mu)$ を$X$ が有限集合である確率測度距離空間とする. $Z$ を$X$ の類似度行列とし, 任意の$x \in X$ に対して
\begin{align*} \sum_{y \in X} Z(x, y)w(y)\mu(y) = 1 \end{align*}
が成り立つ$w$ を$X$ のウェイトということにする. すると残念ながら, 
$w, v$ をともに$X$ のウェイトとすると, 
\begin{align*} \sum w(x) = \sum v(x) \end{align*}
は必ずしも成り立たない. 

\begin{remark}
けど, よく考えたら, もしウェイトがユニークであることが言えれば, これは別に定義できるのでは. つまり, $Z$ がメビウス行列をもつような空間であれば, ウェイトはユニークであるので, 定義できる. 
\end{remark}

















\end{document}